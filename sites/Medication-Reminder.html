<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Medication Reminder</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class'
    }
  </script>
  <style>
    .theme-toggle {
      position: fixed;
      bottom: 20px;
      left: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: #1f2937;
      color: #fbbf24;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 999;
    }
  </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white p-6">
  <div class="max-w-xl mx-auto">
    <h1 class="text-3xl font-bold text-center text-blue-600 dark:text-blue-400 mb-6">Medication Reminder</h1>

    <label for="medicationName" class="block font-semibold mb-1">Medication Name</label>
    <input type="text" id="medicationName" placeholder="Enter medication name" class="w-full mb-4 p-2 border rounded dark:bg-gray-700 dark:border-gray-600">

    <label for="time" class="block font-semibold mb-1">Time</label>
    <input type="time" id="time" class="w-full mb-4 p-2 border rounded dark:bg-gray-700 dark:border-gray-600">

    <button onclick="addMedication()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded">Add Medication</button>

    <h2 class="text-2xl text-red-500 dark:text-red-400 mt-8 mb-4">Next Doses:</h2>
    <div id="remindersContainer" class="space-y-3"></div>

    <div class="flex justify-center space-x-4 mt-8 text-gray-600 dark:text-gray-300">
      <a href="#"><i class="fab fa-linkedin"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
      <a href="#"><i class="fab fa-facebook"></i></a>
    </div>
  </div>

  <button class="theme-toggle" onclick="document.documentElement.classList.toggle('dark')">ðŸŒ“</button>

  <script>
    var remindersInterval;
    var reminderTimeouts = [];

    function addMedication() {
      var medicationName = document.getElementById("medicationName").value;
      var time = document.getElementById("time").value;
      if (medicationName.trim() === "" || time.trim() === "") {
        alert("Please enter the medication name and time.");
        return;
      }
      var medications = JSON.parse(localStorage.getItem("medications")) || [];
      medications.push({ name: medicationName, time: time });
      localStorage.setItem("medications", JSON.stringify(medications));
      document.getElementById("medicationName").value = "";
      document.getElementById("time").value = "";
      displayReminders();
    }

    function removeMedication(index) {
      var medications = JSON.parse(localStorage.getItem("medications")) || [];
      medications.splice(index, 1);
      localStorage.setItem("medications", JSON.stringify(medications));
      displayReminders();
    }

    function displayReminders() {
      var medications = JSON.parse(localStorage.getItem("medications")) || [];
      var remindersContainer = document.getElementById("remindersContainer");
      remindersContainer.innerHTML = "";

      medications.forEach(function(medication, index) {
        var reminderTime = new Date(new Date().toDateString() + " " + medication.time);
        var remainingTime = reminderTime.getTime() - Date.now();
        if (remainingTime <= 0) {
          reminderTime.setDate(reminderTime.getDate() + 1);
          remainingTime = reminderTime.getTime() - Date.now();
        }

        var reminderItem = document.createElement("div");
        reminderItem.className = "p-4 bg-white dark:bg-gray-700 rounded shadow";
        reminderItem.innerHTML = `<strong>${medication.name}</strong> - ${medication.time} - Remaining Time: <span id='remainingTime${index}'>${formatRemainingTime(remainingTime)}</span>`;

        var removeButton = document.createElement("button");
        removeButton.innerHTML = "Remove";
        removeButton.className = "block mt-2 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded";
        removeButton.onclick = function() { removeMedication(index); };

        reminderItem.appendChild(removeButton);
        remindersContainer.appendChild(reminderItem);

        var timeout = setTimeout(function() {
          alert("Time to take your medication: " + medication.name);
        }, remainingTime);
        reminderTimeouts.push(timeout);
      });

      clearInterval(remindersInterval);
      remindersInterval = setInterval(updateRemainingTimes, 1000);
    }

    function updateRemainingTimes() {
      var medications = JSON.parse(localStorage.getItem("medications")) || [];
      medications.forEach(function(medication, index) {
        var reminderTime = new Date(new Date().toDateString() + " " + medication.time);
        var remainingTime = reminderTime.getTime() - Date.now();
        if (remainingTime <= 0) {
          reminderTime.setDate(reminderTime.getDate() + 1);
          remainingTime = reminderTime.getTime() - Date.now();
        }
        document.getElementById("remainingTime" + index).innerHTML = formatRemainingTime(remainingTime);
      });
    }

    function formatRemainingTime(remainingTime) {
      var hours = Math.floor(remainingTime / (1000 * 60 * 60));
      var minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
      var seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);
      return hours + "h " + minutes + "m " + seconds + "s";
    }

    window.onload = displayReminders;
  </script>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</body>

</html>